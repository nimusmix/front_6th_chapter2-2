import{j as e,r as x,R as te,a as se}from"./client-D0sMPr8_.js";const re=({isAdmin:t,setIsAdmin:n,searchTerm:s,setSearchTerm:r,cartLength:a,totalItemCount:i})=>e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-40 border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"SHOP"}),!t&&e.jsx("div",{className:"ml-8 flex-1 max-w-md",children:e.jsx("input",{type:"text",value:s,onChange:c=>r(c.target.value),placeholder:"상품 검색...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"})})]}),e.jsxs("nav",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>n(!t),className:`px-3 py-1.5 text-sm rounded transition-colors ${t?"bg-gray-800 text-white":"text-gray-600 hover:text-gray-900"}`,children:t?"쇼핑몰로 돌아가기":"관리자 페이지로"}),!t&&e.jsxs("div",{className:"relative",children:[e.jsx("svg",{className:"w-6 h-6 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),a>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:i})]})]})]})})}),ne=(t,n)=>{const{discounts:s}=t.product,{quantity:r}=t,a=s.reduce((c,u)=>r>=u.quantity&&u.rate>c?u.rate:c,0);return n.some(c=>c.quantity>=10)?Math.min(a+.05,.5):a},V=(t,n)=>{const{price:s}=t.product,{quantity:r}=t,a=ne(t,n);return Math.round(s*r*(1-a))},$=(t,n)=>{let s=0,r=0;return t.forEach(a=>{const i=a.product.price*a.quantity;s+=i,r+=V(a,t)}),n&&(n.discountType==="amount"?r=Math.max(0,r-n.discountValue):r=Math.round(r*(1-n.discountValue/100))),{totalBeforeDiscount:Math.round(s),totalAfterDiscount:Math.round(r)}},C=(t,n)=>{const s=n.find(a=>a.product.id===t.id);return t.stock-(s?.quantity||0)},ae=(t,n,s,r,a=!1)=>{if(n&&s&&r){const i=s.find(c=>c.id===n);if(i&&C(i,r)<=0)return"SOLD OUT"}return a?`${t.toLocaleString()}원`:`₩${t.toLocaleString()}`},ie=(t,n)=>{if(!n.trim())return t;const s=n.toLowerCase();return t.filter(r=>r.name.toLowerCase().includes(s)||r.description&&r.description.toLowerCase().includes(s))},le=({product:t,cart:n,formatPrice:s,addToCart:r})=>{const a=C(t,n);return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"aspect-square bg-gray-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-24 h-24 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.isRecommended&&e.jsx("span",{className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded",children:"BEST"}),t.discounts.length>0&&e.jsxs("span",{className:"absolute top-2 left-2 bg-orange-500 text-white text-xs px-2 py-1 rounded",children:["~",Math.max(...t.discounts.map(i=>i.rate))*100,"%"]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:t.name}),t.description&&e.jsx("p",{className:"text-sm text-gray-500 mb-2 line-clamp-2",children:t.description}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:s(t.price,t.id)}),t.discounts.length>0&&e.jsxs("p",{className:"text-xs text-gray-500",children:[t.discounts[0].quantity,"개 이상 구매시 할인 ",t.discounts[0].rate*100,"%"]})]}),e.jsxs("div",{className:"mb-3",children:[a<=5&&a>0&&e.jsxs("p",{className:"text-xs text-red-600 font-medium",children:["품절임박! ",a,"개 남음"]}),a>5&&e.jsxs("p",{className:"text-xs text-gray-500",children:["재고 ",a,"개"]})]}),e.jsx("button",{onClick:()=>r(t),disabled:a<=0,className:`w-full py-2 px-4 rounded-md font-medium transition-colors ${a<=0?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800"}`,children:a<=0?"품절":"장바구니 담기"})]})]})},ce=({products:t,filteredProducts:n,debouncedSearchTerm:s,cart:r,formatPrice:a,addToCart:i})=>e.jsxs("section",{children:[e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"전체 상품"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["총 ",t.length,"개 상품"]})]}),n.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsxs("p",{className:"text-gray-500",children:['"',s,'"에 대한 검색 결과가 없습니다.']})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(c=>e.jsx(le,{product:c,cart:r,formatPrice:a,addToCart:i},c.id))})]}),oe=({cart:t,removeFromCart:n,updateQuantity:s})=>e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),"장바구니"]}),t.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),e.jsx("p",{className:"text-gray-500 text-sm",children:"장바구니가 비어있습니다"})]}):e.jsx("div",{className:"space-y-3",children:t.map(r=>{const a=V(r,t),i=r.product.price*r.quantity,c=a<i,u=c?Math.round((1-a/i)*100):0;return e.jsxs("div",{className:"border-b pb-3 last:border-b-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 flex-1",children:r.product.name}),e.jsx("button",{onClick:()=>n(r.product.id),className:"text-gray-400 hover:text-red-500 ml-2",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>s(r.product.id,r.quantity-1),className:"w-6 h-6 rounded border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:e.jsx("span",{className:"text-xs",children:"−"})}),e.jsx("span",{className:"mx-3 text-sm font-medium w-8 text-center",children:r.quantity}),e.jsx("button",{onClick:()=>s(r.product.id,r.quantity+1),className:"w-6 h-6 rounded border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:e.jsx("span",{className:"text-xs",children:"+"})})]}),e.jsxs("div",{className:"text-right",children:[c&&e.jsxs("span",{className:"text-xs text-red-500 font-medium block",children:["-",u,"%"]}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[Math.round(a).toLocaleString(),"원"]})]})]})]},r.product.id)})})]}),de=({notifications:t,removeNotification:n})=>t.length===0?null:e.jsx("div",{className:"fixed top-20 right-4 z-50 space-y-2 max-w-sm",children:t.map(s=>e.jsxs("div",{className:`p-4 rounded-md shadow-md text-white flex justify-between items-center ${s.type==="error"?"bg-red-600":s.type==="warning"?"bg-yellow-600":"bg-green-600"}`,children:[e.jsx("span",{className:"mr-2",children:s.message}),e.jsx("button",{onClick:()=>n(s.id),className:"text-white hover:text-gray-200",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},s.id))}),xe=({activeTab:t,setActiveTab:n,children:s})=>e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"관리자 대시보드"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"상품과 쿠폰을 관리할 수 있습니다"})]}),e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>n("products"),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${t==="products"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"상품 관리"}),e.jsx("button",{onClick:()=>n("coupons"),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${t==="coupons"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"쿠폰 관리"})]})}),s]}),ue=({products:t,showProductForm:n,editingProduct:s,productForm:r,formatPrice:a,deleteProduct:i,startEditProduct:c,handleProductSubmit:u,setProductForm:o,setShowProductForm:g,setEditingProduct:p})=>e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"상품 목록"}),e.jsx("button",{onClick:()=>{p("new"),o({name:"",price:0,stock:0,description:"",discounts:[]}),g(!0)},className:"px-4 py-2 bg-gray-900 text-white text-sm rounded-md hover:bg-gray-800",children:"새 상품 추가"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"상품명"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"가격"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"재고"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"설명"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"작업"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(l=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:l.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a(l.price,l.id)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${l.stock>10?"bg-green-100 text-green-800":l.stock>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[l.stock,"개"]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:l.description||"-"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>c(l),className:"text-indigo-600 hover:text-indigo-900 mr-3",children:"수정"}),e.jsx("button",{onClick:()=>i(l.id),className:"text-red-600 hover:text-red-900",children:"삭제"})]})]},l.id))})]})}),n&&e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:s==="new"?"새 상품 추가":"상품 수정"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"상품명"}),e.jsx("input",{type:"text",value:r.name,onChange:l=>o({...r,name:l.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"설명"}),e.jsx("input",{type:"text",value:r.description,onChange:l=>o({...r,description:l.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"가격"}),e.jsx("input",{type:"text",value:r.price===0?"":r.price,onChange:l=>{const{value:d}=l.target;(d===""||/^\d+$/.test(d))&&o({...r,price:d===""?0:parseInt(d)})},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",placeholder:"숫자만 입력",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"재고"}),e.jsx("input",{type:"text",value:r.stock===0?"":r.stock,onChange:l=>{const{value:d}=l.target;(d===""||/^\d+$/.test(d))&&o({...r,stock:d===""?0:parseInt(d)})},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",placeholder:"숫자만 입력",required:!0})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"할인 정책"}),e.jsxs("div",{className:"space-y-2",children:[r.discounts.map((l,d)=>e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 p-2 rounded",children:[e.jsx("input",{type:"number",value:l.quantity,onChange:h=>{const b=[...r.discounts];b[d].quantity=parseInt(h.target.value)||0,o({...r,discounts:b})},className:"w-20 px-2 py-1 border rounded",min:"1",placeholder:"수량"}),e.jsx("span",{className:"text-sm",children:"개 이상 구매 시"}),e.jsx("input",{type:"number",value:l.rate*100,onChange:h=>{const b=[...r.discounts];b[d].rate=(parseInt(h.target.value)||0)/100,o({...r,discounts:b})},className:"w-16 px-2 py-1 border rounded",min:"0",max:"100",placeholder:"%"}),e.jsx("span",{className:"text-sm",children:"% 할인"}),e.jsx("button",{type:"button",onClick:()=>{const h=r.discounts.filter((b,y)=>y!==d);o({...r,discounts:h})},className:"text-red-600 hover:text-red-800",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},d)),e.jsx("button",{type:"button",onClick:()=>{o({...r,discounts:[...r.discounts,{quantity:10,rate:.1}]})},className:"text-sm text-indigo-600 hover:text-indigo-800",children:"+ 할인 추가"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{p(null),o({name:"",price:0,stock:0,description:"",discounts:[]}),g(!1)},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"취소"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm font-medium hover:bg-indigo-700",children:s==="new"?"추가":"수정"})]})]})})]}),me=({coupons:t,showCouponForm:n,couponForm:s,deleteCoupon:r,handleCouponSubmit:a,setCouponForm:i,setShowCouponForm:c,addNotification:u})=>e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold",children:"쿠폰 관리"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[t.map(o=>e.jsx("div",{className:"relative bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-4 border border-indigo-200",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:o.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1 font-mono",children:o.code}),e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-white text-indigo-700",children:o.discountType==="amount"?`${o.discountValue.toLocaleString()}원 할인`:`${o.discountValue}% 할인`})})]}),e.jsx("button",{onClick:()=>r(o.code),className:"text-gray-400 hover:text-red-600 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})},o.code)),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 flex items-center justify-center hover:border-gray-400 transition-colors",children:e.jsxs("button",{onClick:()=>c(!n),className:"text-gray-400 hover:text-gray-600 flex flex-col items-center",children:[e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("p",{className:"mt-2 text-sm font-medium",children:"새 쿠폰 추가"})]})})]}),n&&e.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:e.jsxs("form",{onSubmit:a,className:"space-y-4",children:[e.jsx("h3",{className:"text-md font-medium text-gray-900",children:"새 쿠폰 생성"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"쿠폰명"}),e.jsx("input",{type:"text",value:s.name,onChange:o=>i({...s,name:o.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",placeholder:"신규 가입 쿠폰",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"쿠폰 코드"}),e.jsx("input",{type:"text",value:s.code,onChange:o=>i({...s,code:o.target.value.toUpperCase()}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm font-mono",placeholder:"WELCOME2024",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"할인 타입"}),e.jsxs("select",{value:s.discountType,onChange:o=>i({...s,discountType:o.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",children:[e.jsx("option",{value:"amount",children:"정액 할인"}),e.jsx("option",{value:"percentage",children:"정률 할인"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s.discountType==="amount"?"할인 금액":"할인율(%)"}),e.jsx("input",{type:"text",value:s.discountValue===0?"":s.discountValue,onChange:o=>{const{value:g}=o.target;(g===""||/^\d+$/.test(g))&&i({...s,discountValue:g===""?0:parseInt(g)})},onBlur:o=>{const g=parseInt(o.target.value)||0;s.discountType==="percentage"?g>100?(u("할인율은 100%를 초과할 수 없습니다","error"),i({...s,discountValue:100})):g<0&&i({...s,discountValue:0}):g>1e5?(u("할인 금액은 100,000원을 초과할 수 없습니다","error"),i({...s,discountValue:1e5})):g<0&&i({...s,discountValue:0})},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",placeholder:s.discountType==="amount"?"5000":"10",required:!0})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>c(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"취소"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm font-medium hover:bg-indigo-700",children:"쿠폰 생성"})]})]})})]})]});function D(t,n){const[s,r]=x.useState(()=>{try{const i=window.localStorage.getItem(t);return i?JSON.parse(i):n}catch(i){return console.error(`Error reading localStorage key "${t}":`,i),n}});return[s,i=>{try{const c=i instanceof Function?i(s):i;r(c),c!=null?window.localStorage.setItem(t,JSON.stringify(c)):window.localStorage.removeItem(t)}catch(c){console.error(`Error setting localStorage key "${t}":`,c)}}]}function he(){const[t,n]=x.useState([]),s=x.useCallback((a,i="success")=>{const c=Date.now().toString();n(u=>[...u,{id:c,message:a,type:i}]),setTimeout(()=>{n(u=>u.filter(o=>o.id!==c))},3e3)},[]),r=x.useCallback(a=>{n(i=>i.filter(c=>c.id!==a))},[]);return{notifications:t,addNotification:s,removeNotification:r}}function ge(t=500){const[n,s]=x.useState(""),[r,a]=x.useState("");return x.useEffect(()=>{const i=setTimeout(()=>{a(n)},t);return()=>clearTimeout(i)},[n,t]),{searchTerm:n,setSearchTerm:s,debouncedSearchTerm:r}}function be(t,n){const[s,r]=x.useState(()=>{const l=localStorage.getItem("cart");if(l)try{return JSON.parse(l)}catch{return[]}return[]}),[a,i]=x.useState(0);x.useEffect(()=>{const l=s.reduce((d,h)=>d+h.quantity,0);i(l)},[s]),x.useEffect(()=>{s.length>0?localStorage.setItem("cart",JSON.stringify(s)):localStorage.removeItem("cart")},[s]);const c=x.useCallback(l=>{if(C(l,s)<=0){n("재고가 부족합니다!","error");return}r(h=>{const b=h.find(y=>y.product.id===l.id);if(b){const y=b.quantity+1;return y>l.stock?(n(`재고는 ${l.stock}개까지만 있습니다.`,"error"),h):h.map(j=>j.product.id===l.id?{...j,quantity:y}:j)}return[...h,{product:l,quantity:1}]}),n("장바구니에 담았습니다","success")},[s,n]),u=x.useCallback(l=>{r(d=>d.filter(h=>h.product.id!==l))},[]),o=x.useCallback((l,d)=>{if(d<=0){u(l);return}const h=t.find(y=>y.id===l);if(!h)return;const b=h.stock;if(d>b){n(`재고는 ${b}개까지만 있습니다.`,"error");return}r(y=>y.map(j=>j.product.id===l?{...j,quantity:d}:j))},[t,u,n]),g=x.useCallback(()=>{r([])},[]),p=x.useCallback(l=>$(s,l),[s]);return{cart:s,totalItemCount:a,addToCart:c,removeFromCart:u,updateQuantity:o,clearCart:g,getCartTotal:p}}function pe(t,n,s,r,a,i){const c=x.useCallback(p=>{if(t.find(d=>d.code===p.code)){a("이미 존재하는 쿠폰 코드입니다.","error");return}n(d=>[...d,p]),a("쿠폰이 추가되었습니다.","success")},[t,n,a]),u=x.useCallback(p=>{n(l=>l.filter(d=>d.code!==p)),s?.code===p&&r(null),a("쿠폰이 삭제되었습니다.","success")},[s,n,r,a]),o=x.useCallback(p=>{if(i(s).totalAfterDiscount<1e4&&p.discountType==="percentage"){a("percentage 쿠폰은 10,000원 이상 구매 시 사용 가능합니다.","error");return}r(p),a("쿠폰이 적용되었습니다.","success")},[s,i,r,a]),g=x.useCallback(()=>{r(null)},[r]);return{addCoupon:c,deleteCoupon:u,applyCoupon:o,clearSelectedCoupon:g}}const ye=(t,n)=>({addProduct:i=>{const c={id:`p${Date.now()}`,...i};t(u=>[...u,c]),n("상품이 추가되었습니다.","success")},updateProduct:(i,c)=>{t(u=>u.map(o=>o.id===i?{...o,...c}:o)),n("상품이 수정되었습니다.","success")},deleteProduct:i=>{t(c=>c.filter(u=>u.id!==i)),n("상품이 삭제되었습니다.","warning")}}),je=[{id:"p1",name:"상품1",price:1e4,stock:20,discounts:[{quantity:10,rate:.1},{quantity:20,rate:.2}],description:"최고급 품질의 프리미엄 상품입니다."},{id:"p2",name:"상품2",price:2e4,stock:20,discounts:[{quantity:10,rate:.15}],description:"다양한 기능을 갖춘 실용적인 상품입니다.",isRecommended:!0},{id:"p3",name:"상품3",price:3e4,stock:20,discounts:[{quantity:10,rate:.2},{quantity:30,rate:.25}],description:"대용량과 고성능을 자랑하는 상품입니다."}],fe=[{name:"5000원 할인",code:"AMOUNT5000",discountType:"amount",discountValue:5e3},{name:"10% 할인",code:"PERCENT10",discountType:"percentage",discountValue:10}],Ne=()=>{const[t,n]=D("products",je),[s,r]=D("coupons",fe),[a,i]=x.useState(null),[c,u]=x.useState(!1),[o,g]=x.useState(!1),[p,l]=x.useState("products"),[d,h]=x.useState(!1),[b,y]=x.useState(null),[j,k]=x.useState({name:"",price:0,stock:0,description:"",discounts:[]}),[S,L]=x.useState({name:"",code:"",discountType:"amount",discountValue:0}),{notifications:P,addNotification:N,removeNotification:B}=he(),{searchTerm:I,setSearchTerm:E,debouncedSearchTerm:T}=ge(),{cart:v,totalItemCount:O,addToCart:R,removeFromCart:A,updateQuantity:W,clearCart:M,getCartTotal:H}=be(t,N),{addCoupon:z,deleteCoupon:J,applyCoupon:U}=pe(s,r,a,i,N,H),{addProduct:_,updateProduct:G,deleteProduct:K}=ye(n,N),q=(m,w)=>ae(m,w,t,v,c),Q=x.useCallback(()=>{const m=`ORD-${Date.now()}`;N(`주문이 완료되었습니다. 주문번호: ${m}`,"success"),M(),i(null)},[N,M]),X=m=>{m.preventDefault(),b&&b!=="new"?(G(b,j),y(null)):_({...j,discounts:j.discounts}),k({name:"",price:0,stock:0,description:"",discounts:[]}),y(null),h(!1)},Y=m=>{m.preventDefault(),z(S),L({name:"",code:"",discountType:"amount",discountValue:0}),g(!1)},Z=m=>{y(m.id),k({name:m.name,price:m.price,stock:m.stock,description:m.description||"",discounts:m.discounts||[]}),h(!0)},f=$(v,a),F=ie(t,T);return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(de,{notifications:P,removeNotification:B}),e.jsx(re,{isAdmin:c,setIsAdmin:u,searchTerm:I,setSearchTerm:E,cartLength:v.length,totalItemCount:O}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 py-8",children:c?e.jsx(xe,{activeTab:p,setActiveTab:l,children:p==="products"?e.jsx(ue,{products:t,showProductForm:d,editingProduct:b,productForm:j,formatPrice:q,deleteProduct:K,startEditProduct:Z,handleProductSubmit:X,setProductForm:k,setShowProductForm:h,setEditingProduct:y}):e.jsx(me,{coupons:s,showCouponForm:o,couponForm:S,deleteCoupon:J,handleCouponSubmit:Y,setCouponForm:L,setShowCouponForm:g,addNotification:N})}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsx(ce,{products:t,filteredProducts:F,debouncedSearchTerm:T,cart:v,formatPrice:q,addToCart:R})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"sticky top-24 space-y-4",children:[e.jsx(oe,{cart:v,removeFromCart:A,updateQuantity:W}),v.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"쿠폰 할인"}),e.jsx("button",{className:"text-xs text-blue-600 hover:underline",children:"쿠폰 등록"})]}),s.length>0&&e.jsxs("select",{className:"w-full text-sm border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500",value:a?.code||"",onChange:m=>{const w=s.find(ee=>ee.code===m.target.value);w?U(w):i(null)},children:[e.jsx("option",{value:"",children:"쿠폰 선택"}),s.map(m=>e.jsxs("option",{value:m.code,children:[m.name," (",m.discountType==="amount"?`${m.discountValue.toLocaleString()}원`:`${m.discountValue}%`,")"]},m.code))]})]}),e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"결제 정보"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"상품 금액"}),e.jsxs("span",{className:"font-medium",children:[f.totalBeforeDiscount.toLocaleString(),"원"]})]}),f.totalBeforeDiscount-f.totalAfterDiscount>0&&e.jsxs("div",{className:"flex justify-between text-red-500",children:[e.jsx("span",{children:"할인 금액"}),e.jsxs("span",{children:["-",(f.totalBeforeDiscount-f.totalAfterDiscount).toLocaleString(),"원"]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-t border-gray-200",children:[e.jsx("span",{className:"font-semibold",children:"결제 예정 금액"}),e.jsxs("span",{className:"font-bold text-lg text-gray-900",children:[f.totalAfterDiscount.toLocaleString(),"원"]})]})]}),e.jsxs("button",{onClick:Q,className:"w-full mt-4 py-3 bg-yellow-400 text-gray-900 rounded-md font-medium hover:bg-yellow-500 transition-colors",children:[f.totalAfterDiscount.toLocaleString(),"원 결제하기"]}),e.jsx("div",{className:"mt-3 text-xs text-gray-500 text-center",children:e.jsx("p",{children:"* 실제 결제는 이루어지지 않습니다"})})]})]})]})})]})})]})};te.createRoot(document.getElementById("root")).render(e.jsx(se.StrictMode,{children:e.jsx(Ne,{})}));
